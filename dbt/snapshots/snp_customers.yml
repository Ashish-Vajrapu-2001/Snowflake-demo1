snapshots:
  - name: snp_customers
    relation: source('bronze_crm', 'CUSTOMERS')
    config:
      target_schema: SILVER_CRM
      unique_key: CUSTOMER_ID
      strategy: timestamp
      updated_at: _FIVETRAN_SYNCED
      hard_deletes: new_record
      dbt_valid_to_current: "to_date('9999-12-31')"
    description: "SCD2 snapshot of Customers"
    columns:
      - name: dbt_scd_id
        description: "Surrogate key"
      - name: CUSTOMER_ID
        description: "Business key"
      - name: dbt_valid_from
        description: "Valid from timestamp"
      - name: dbt_valid_to
        description: "Valid to timestamp"
      - name: dbt_is_current
        description: "Is current record"
      - name: dbt_is_deleted
        description: "Is deleted record"